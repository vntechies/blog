---
title: C√†i ƒë·∫∑t v√† c·∫•u h√¨nh AWS CLI tr√™n Linux
date: '2023-03-20'
tags: ['aws', 'awscli', 'cloud']
draft: false
images: ['/static/images/ogps/awscliubuntu.png']
summary: 'Trong b√†i vi·∫øt n√†y, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu c√°ch c√†i ƒë·∫∑t v√† c·∫•u h√¨nh AWS CLI tr√™n h·ªá th·ªëng Linux. Ch√∫ng ta c≈©ng s·∫Ω xem x√©t t·∫•t c·∫£ c√°c ph∆∞∆°ng ph√°p c·∫•u h√¨nh v√† chi ti·∫øt quan tr·ªçng c·ªßa AWS CLI.'
---

Trong b√†i vi·∫øt n√†y, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu c√°ch c√†i ƒë·∫∑t v√† c·∫•u h√¨nh AWS CLI tr√™n h·ªá th·ªëng Linux. Ch√∫ng ta c≈©ng s·∫Ω xem x√©t t·∫•t c·∫£ c√°c ph∆∞∆°ng ph√°p c·∫•u h√¨nh v√† chi ti·∫øt quan tr·ªçng c·ªßa AWS CLI.

<TOCInline toc={props.toc} asDisclosure />

## ƒêi·ªÅu ki·ªán tr∆∞·ªõc ti√™n

D∆∞·ªõi ƒë√¢y l√† c√°c ƒëi·ªÅu ki·ªán c·∫ßn c√≥ ƒë·ªÉ c√†i ƒë·∫∑t v√† c·∫•u h√¨nh AWS CLI.

- M·ªôt t√†i kho·∫£n AWS h·ª£p l·ªá
- AWS IAM user v·ªõi access key v√† secret key v·ªõi quy·ªÅn truy c·∫≠p c√°c d·ªãch v·ª• c·ªßa AWS. N·∫øu ch∆∞a c√≥, b·∫°n c√≥ th·ªÉ t·∫°o m·ªõi v√† l·∫•y t·ª´ AWS IAM.

## C√†i ƒë·∫∑t AWS CLI

### B∆∞·ªõc 1: Download t·ªáp c√†i ƒë·∫∑t AWS CLI s·ª≠ d·ª•ng curl

```shell
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
```

ho·∫∑c c√¢u l·ªánh d∆∞·ªõi d√¢y cho c√°c m√°y s·ª≠ d·ª•ng ki·∫øn tr√∫c ARM

```shell
curl "https://awscli.amazonaws.com/awscli-exe-linux-aarch64.zip" -o "awscliv2.zip"
```

### B∆∞·ªõc 2: Gi·∫£i n√©n c√°c t·∫≠p tin.

```shell
unzip awscliv2.zip
```

### B∆∞·ªõc 3: C√†i ƒë·∫∑t aws-cli

```shell
sudo ./aws/install
```

L·ªánh tr√™n t·∫°o m·ªôt li√™n k·∫øt v·∫≠t l√Ω c√≥ t√™n aws trong th∆∞ m·ª•c `/usr/local/bin` v√† th√™m t·ªáp th·ª±c thi c·ªßa AWS CLI t·∫°i `/usr/local/aws-cli`.

![li√™n k·∫øt v·∫≠t l√Ω aws cli](/static/images/assets/awscli1.png)

### B∆∞·ªõc 4: Ki·ªÉm tra phi√™n b·∫£n AWS CLI, x√°c nh·∫≠n c√†i ƒë·∫∑t th√†nh c√¥ng

```shell
> aws --version
aws-cli/2.11.4 Python/3.11.2 Linux/5.15.0-67-generic exe/aarch64.ubuntu.22 prompt/off
```

## C·∫•u h√¨nh AWS CLI

ƒê·ªÉ truy c·∫≠p c√°ch d·ªãch v·ª• AWS t·ª´ CLI, b·∫°n c·∫ßn c·∫•u h√¨nh CLI b·∫±ng access key v√† secret key c·ªßa AWS. B·∫°n c√≥ th·ªÉ l√†m ƒëi·ªÅu n√†y b·∫±ng 2 c√°ch: s·ª≠ d·ª•ng CLI ho·∫∑c s·ª≠ d·ª•ng bi·∫øn m√¥i tr∆∞·ªùng

### S·ª≠ d·ª•ng command line

S·ª≠ d·ª•ng CLI, b·∫°n c√≥ th·ªÉ ƒë·ªãnh c·∫•u h√¨nh access keys v√† secret keys c·ªßa AWS v√† c√°c gi√° tr·ªã m·∫∑c ƒë·ªãnh v√† l∆∞u l·∫°i c√°c c·∫•u h√¨nh trong th∆∞ m·ª•c `~/.aws`.

B·∫°n c√≥ th·ªÉ ch·ªçn c√°ch n√†y cho m√°y tr·∫°m c·ªßa m√¨nh. N·∫øu mu·ªën s·ª≠ d·ª•n nhi·ªÅu t√†i kho·∫£n AWS, b·∫°n c√≥ th·ªÉ c·∫•u h√¨nh s·ª≠ d·ª•ng profile, ch√∫ng ta s·∫Ω ƒë·ªÅ c·∫≠p ·ªü ph·∫©n sau c·ªßa b√†i vi·∫øt.

ƒê·ªÉ c·∫•u h√¨nh b·∫±ng CLI, th·ª±c hi·ªán l·ªánh sau.

```shell
aws configure
```

B·∫°n s·∫Ω ph·∫£i nh·∫≠p access key, secret key, region v√† ƒë·ªãnh d·∫°ng ƒë·∫ßu ra m·∫∑c ƒë·ªãnh (json, yaml, yaml-stream, text, table). Cung c·∫•p c√°c chi ti·∫øt theo h∆∞·ªõng d·∫´n sau.

```shell
> aws configure
AWS Access Key ID [None]: AKIAVFK6HGGG4DPNBE6W
AWS Secret Access Key [None]: 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
Default region name [None]: us-east-1
Default output format [None]: yaml
```

Sau khi c·∫•u h√¨nh, b·∫°n s·∫Ω th·∫•y hai t·ªáp sau trong th∆∞ m·ª•c `.aws`

```shell
> cd $HOME/.aws
> ls
config  credentials
```

![n·ªôi dung c√°c file c·ªßa aws config](/static/images/assets/awscli2.png)

- `config`: Ch·ª©a t·∫•t c·∫£ c√°c c·∫•u h√¨nh m·∫∑c ƒë·ªãnh nh∆∞ region v√† ƒë·ªãnh d·∫°ng ƒë·∫ßu ra. B·∫°n c√≥ th·ªÉ thay ƒë·ªïi c√°c gi√° tr·ªã n√†y b·∫•t k·ª≥ l√∫c n√†o thay cho c√°c gi√° tr·ªã m·∫∑c ƒë·ªãnh.
- `credentials`: T·ªáp n√†y ch·ª©a access key v√† secret key d∆∞·ªõi d·∫°ng plain text.

C√°c gi√° tr·ªã trong c√°c t·ªáp tr√™n c√≥ th·ªÉ ƒë∆∞·ª£c ghi ƒë√® th√¥ng qua c√°c bi·∫øn m√¥i tr∆∞·ªùng CLI.

Sau khi c·∫•u h√¨nh AWS CLI, h√£y th·ª≠ t·∫°o m·ªôt S3 bucket s·ª≠ d·ª•ng c√¢u l·ªánh

```shell
> aws s3api create-bucket --bucket bucket-sieu-to-khong-lo-se-duoc-xoa
Location: /bucket-sieu-to-khong-lo-se-duoc-xoa

> aws s3api list-buckets
Buckets:
- CreationDate: '2023-03-20T08:08:06+00:00'
  Name: bucket-sieu-to-khong-lo-se-duoc-xoa
Owner:
  DisplayName: lab+LabServices-Prod-2769
  ID: 1d523b3e9bfc2accbb4c6045f44ca5c0c100f958207e41779a8412206ecbb39b
```

### S·ª≠ d·ª•ng bi·∫øn m√¥i tr∆∞·ªùng

AWS CLI h·ªó tr·ª£ c√°c bi·∫øn m√¥i tr∆∞·ªùng. N·∫øu b·∫°n c·∫•u h√¨nh c√°c gi√° tr·ªã d∆∞·ªõi d·∫°ng bi·∫øn m√¥i tr∆∞·ªùng, AWS CLI s·∫Ω s·ª≠ d·ª•ng c√°c gi√° tr·ªã ƒë√≥ ƒë·ªÉ x√°c th·ª±c v·ªõi AWS. D∆∞·ªõi ƒë√¢y l√† c√°c bi·∫øn m√¥i tr∆∞·ªùng quan tr·ªçng

| CLI Environment Variable | Value                                                                       |
| ------------------------ | --------------------------------------------------------------------------- |
| AWS_ACCESS_KEY_ID        | AWS Access key                                                              |
| AWS_SECRET_ACCESS_KEY    | AWS Secret key                                                              |
| AWS_DEFAULT_REGION       | Region AWS m·∫∑c ƒë·ªãnh. Example, us-east-1                                     |
| AWS_DEFAULT_OUTPUT       | ƒê·ªãnh d·∫°ng m·∫∑c ƒë·ªãnh c·ªßa AWS CLI.<br/>[json, yaml, yaml-stream, text & table] |

B·∫°n c√≥ th·ªÉ c√†i ƒë·∫∑t bi·∫øn m√¥i tr∆∞·ªùng b·∫±ng l·ªánh `export` nh∆∞ d∆∞·ªõi d√¢y. Thay th·∫ø c√°c bi·∫øn b·∫±ng gi√° tr·ªã c·ªßa b·∫°n.

```shell
export AWS_ACCESS_KEY_ID=AKIAVFK6HGGG4DPNBE6W
export AWS_SECRET_ACCESS_KEY=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
export AWS_DEFAULT_REGION=us-east-1
export AWS_DEFAULT_OUTPUT=json
```

ƒê·ªÉ bi·∫øt c√°c bi·∫øn m√¥i tr∆∞·ªùng c√≥ s·∫µn, tham kh·∫£o [t√†i li·ªáu ch√≠nh th·ª©c c·ªßa AWS CLI](https://docs.aws.amazon.com/cli/latest/topic/config-vars.html).

ƒê·ªÉ x√°c minh c·∫•u h√¨nh, h√£y th·ª±c hi·ªán l·ªánh sau.

```shell
> aws s3api list-buckets
Buckets:
- CreationDate: '2023-03-20T08:08:06+00:00'
  Name: bucket-sieu-to-khong-lo-se-duoc-xoa
Owner:
  DisplayName: lab+LabServices-Prod-2769
  ID: 1d523b3e9bfc2accbb4c6045f44ca5c0c100f958207e41779a8412206ecbb39b
```

**L∆∞u √Ω quan tr·ªçng**: C√°c bi·∫øn m√¥i tr∆∞·ªùng ch·ªâ kh·∫£ d·ª•ng trong phi√™n l√†m vi·ªác v·ªõi shell c·ªßa ng∆∞·ªùi d√πng. N·∫øu b·∫°n ƒëƒÉng xu·∫•t, b·∫°n c·∫ßn c√†i ƒë·∫∑t l·∫°i c√°c bi·∫øn ƒë·ªÉ n√≥ c√≥ s·∫µn cho phi√™n l√†m vi·ªác m·ªõi. Ngo√†i ra, c√°c bi·∫øn m√¥i tr∆∞·ªùng s·∫Ω ghi ƒë√® c·∫•u h√¨nh m·∫∑c ƒë·ªãnh c√≥ t·∫°i `$HOME/.aws`.

### C·∫•u h√¨nh AWS CLI s·ª≠ d·ª•ng nhi·ªÅu t√†i kho·∫£n AWS b·∫±ng profiles

Trong nhi·ªÅu tr∆∞·ªùng h·ª£p, b·∫°n c·∫ßn k·∫øt ·ªëi v·ªõi nhi·ªÅu t√†i kho·∫£n AWS t·ª´ m·ªôt m√°y tr·∫°m (VD: t√†i kho·∫£n dev, stg,prod,...), b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c·∫•u h√¨nh profile cho AWS CLI.

B·∫°n c√≥ th·ªÉ t·∫°o m·ªôt profile m·ªõi b·∫±ng c√°ch s·ª≠ d·ª•ng l·ªánh sau. Trong ƒë√≥ dev l√† t√™n profile. B·∫°n c√≥ th·ªÉ t·∫°o nhi·ªÅu profile v·ªõi c√°c t√™n kh√°c nhau.

```shell
aws configure --profile dev
```

Sau khi c·∫•u h√¨nh profile, b·∫°n c√≥ th·ªÉ th·∫•y c√°c gi√° tr·ªã trong t·ªáp `$HOME/.aws/` nh∆∞ d∆∞·ªõi ƒë√¢y

![c√°c gi√° tr·ªã trong t·ªáp c·∫•u h√¨nh](/static/images/assets/awslinux3.png)

C√°c th√¥ng tin x√°c th·ª±c c≈©ng ƒë∆∞·ª£c l∆∞u trong t·ªáp `$HOME/.aws/credentials`

> B·∫°n c≈©ng c√≥ th·ªÉ nh·∫≠p th√¥ng tin h·ªì s∆° theo c√°ch th·ªß c√¥ng v√†o t·ªáp `config` v√† `credentials`

ƒê·ªÉ ch·ªçn ho·∫∑c di chuy·ªÉn gi·ªØa c√°c profile kh√°c nhau, h√£y s·ª≠ d·ª•ng bi·∫øn m√¥i tr∆∞·ªùng AWS_PROFILE v·ªõi t√™n profile mong mu·ªën nh∆∞ d∆∞·ªõi ƒë√¢y.

```shell
export AWS_PROFILE=dev
```

Ngo√†i ra, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng profile cho c√°c l·ªánh CLI ri√™ng bi·ªát nh∆∞ d∆∞·ªõi ƒë√¢y.

```shell
aws s3api delete-bucket --bucket bucket-sieu-to-khong-lo-se-duoc-xoa --profile dev
```

### C·∫•u h√¨nh ƒë·ªãnh d·∫°ng ƒë·∫ßu ra AWS CLI

ƒê·ªÉ thay ƒë·ªïi ƒë·ªãnh d·∫°ng ƒë·∫ßu ra c·ªßa AWS CLI, b·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a t·ªáp c·∫•u h√¨nh ho·∫∑c ch·∫°y l·ªánh aws configure ƒë·ªÉ c·∫≠p nh·∫≠t ƒë·ªãnh d·∫°ng ƒë·∫ßu ra m·ªõi.

Ngo√†i ra, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c·ªù --output v·ªõi l·ªánh aws ƒë·ªÉ ghi ƒë√® ƒë·ªãnh d·∫°ng ƒë·∫ßu ra m·∫∑c ƒë·ªãnh.

V√≠ d·ª•: ƒë·ªÉ li·ªát k√™ c√°c S3 buckets ·ªü ƒë·ªãnh d·∫°ng b·∫£ng, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh sau v·ªõi c·ªù --output.

```shell
aws ec2 description-instance --output table
```

V√† d·∫ßu ra s·∫Ω xu·∫•t hi·ªán d∆∞·ªõi d·∫°ng sau.

![ƒë·∫ßu ra d∆∞·ªõi d·∫°ng b·∫£ng c·ªßa aws cli](/static/images/assets/awsclilinux4.png)

## C√°c c·∫•u h√¨nh quan tr·ªçng c·ªßa AWS CLI

B·∫£ng d∆∞·ªõi ƒë√¢y c√≥ c√°c c·∫•u h√¨nh AWS CLI quan tr·ªçng v√† v·ªã tr√≠ c·ªßa ch√∫ng.

| AWS CLI Configuration                        | Details                                                                               |
| -------------------------------------------- | ------------------------------------------------------------------------------------- |
| V·ªã tr√≠ c·∫•u h√¨nh m·∫∑c ƒë·ªãnh                     | $HOME/.aws/config                                                                     |
| V·ªã tr√≠ th√¥ng tin x√°c th·ª±c m·∫∑c ƒë·ªãnh.          | $HOME/.aws/credentials                                                                |
| Bi·∫øn m√¥i tr∆∞·ªùng thay ƒë·ªïi profile c·ªßa AWS CLI | AWS_PROFILE                                                                           |
| AWS_DEFAULT_OUTPUT                           | C√°c ƒë·ªãnh d·∫°ng ƒë·∫ßu ra AWS CLI ƒë∆∞·ª£c h·ªó tr·ª£.<br/>[json, yaml, yaml-stream, text & table] |

## C√°c best practices c·ªßa AWS CLI

Sau ƒë√¢y l√† m·ªôt s·ªë best practices khi s·ª≠ d·ª•ng AWS CLI.

- Lu√¥n b·∫£o m·∫≠t th√¥ng tin ƒëƒÉng nh·∫≠p AWS c·ªßa b·∫°n, ƒë·∫£m b·∫£o b·∫°n kh√¥ng v√¥ t√¨nh ƒë·ªÉ access key v√† secret key trong m√£ ngu·ªìn.
- S·ª≠ d·ª•ng c√°c profile ƒë·ªÉ k·∫øt n·ªëi v·ªõi c√°c t√†i kho·∫£n AWS kh√°c nhau.
- Khi s·ª≠ d·ª•ng c√°c profiles, h√£y lu√¥n x√°c minh m√¥i tr∆∞·ªùng m√† b·∫°n ƒëang ch·∫°y l·ªánh CLI tr∆∞·ªõc khi th·ª±c thi l·ªánh v√¨ b·∫°n c√≥ th·ªÉ v√¥ t√¨nh x√≥a ho·∫∑c c·∫≠p nh·∫≠t c√°c d·ªãch v·ª• s·∫£n xu·∫•t.
- N·∫øu b·∫°n mu·ªën s·ª≠ d·ª•ng AWS CLI tr√™n EC2, h√£y lu√¥n s·ª≠ d·ª•ng IAM role thay cho access key v√† secret key.

## AWS CLI Tips

V√¨ ƒë·∫ßu ra c·ªßa AWS CLI tr√™n Linux s·∫Ω ƒë∆∞·ª£c thu g·ªçn, n·∫øu b·∫°n mu·ªën xem to√†n b·ªô ƒë·∫ßu ra b·∫±ng CLI, h√£y c·∫•u h√¨nh bi·∫øn m√¥i tr∆∞·ªùng AWS_PAGER th√†nh m·ªôt chu·ªói tr·ªëng nh∆∞ minh h·ªça b√™n d∆∞·ªõi.

```shell
export AWS_PAGER=""
```

B·∫°n c≈©ng c√≥ th·ªÉ ƒë·∫∑t c·∫•u h√¨nh n√†y b·∫±ng t·ªáp c·∫•u h√¨nh nh∆∞ b√™n d∆∞·ªõi.

```shell
[default]
region = us-east-1
output = json
aws_page=""
```

## K·∫øt lu·∫≠n

Trong b√†i vi·∫øt n√†y, ch√∫ng ta ƒë√£ n√≥i v·ªÅ c√°ch c√†i ƒë·∫∑t v√† c√°c c·∫•u h√¨nh quan tr·ªçng c·ªßa AWS CLI.

L√†m vi·ªác v·ªõi AWS CLI l√† k·ªπ nƒÉng quan tr·ªçng ƒë·ªëi v·ªõi c√°c K·ªπ s∆∞ DevOps l√†m vi·ªác tr√™n m√¥i tr∆∞·ªùng ƒëi·ªán to√°n ƒë√°m m√¢y, b·∫°n s·∫Ω ph·∫£i thi·∫øt l·∫≠p CLI tr√™n m√°y tr·∫°m ho·∫∑c m√°y ch·ªß ƒë·ªÉ ph·ª•c v·ª• cho c√°c t√°c v·ª• t·ª± ƒë·ªông ho√°.

Khi l√†m vi·ªác v·ªõi CI/CD pipelines, h√£y l∆∞u t√¢m v√† th·ª±c h√†nh c√°c ph∆∞∆°ng ph√°p b·∫£o m·∫≠t t·ªët nh·∫•t ƒë·ªÉ c·∫•u h√¨nh CLI b·∫±ng c√°ch gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p d·ªãch v·ª• AWS ƒë·ªëi v·ªõi m·ªói IAM role/user ƒë∆∞·ª£c t·∫°o.

## Tham kh·∫£o

B√†i vi√™t c√≥ s·ª≠ d·ª•ng t∆∞ li·ªáu t·ª´ hai ngu·ªìn sau:

- https://devopscube.com/install-configure-aws-cli-linux/
- https://aws.amazon.com/vi/cli/

## VNTechies Dev Blog

Kho t√†i nguy√™n m√£ ngu·ªìn m·ªü v·ªõi s·ª© m·ªánh ƒë√†o t·∫°o ki·∫øn th·ª©c, ƒë·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp cho c·ªông ƒë·ªìng Cloud ‚òÅÔ∏è DevOps üöÄ

[![Facebook page](/static/images/default-ogp.png)](https://www.facebook.com/vntechies)

Tham gia group [VNTechies - Cloud ‚òÅÔ∏è / DevOps üöÄ](https://www.facebook.com/groups/acevntechies) n·∫øu b·∫°n mu·ªën giao l∆∞u v·ªõi c·ªông ƒë·ªìng v√† c·∫≠p nh·∫≠t c√°c th√¥ng tin m·ªõi nh·∫•t v·ªÅ Cloud v√† DevOps.

- Website: https://vntechies.dev
- Github repository: https://github.com/vntechies
- Facebook page: https://facebook.com/vntechies

[![Discord banner](https://images.viblo.asia/c8c4a473-c08d-45a3-be57-821781c1c256.png)](https://discord.com/invite/k2uDgd7NZ4)

Anh ch·ªã em h√£y follow/·ªßng h·ªô VNTechies ƒë·ªÉ c·∫≠p nh·∫≠t nh·ªØng th√¥ng tin m·ªõi nh·∫•t v·ªÅ Cloud v√† DevOps nh√©!
