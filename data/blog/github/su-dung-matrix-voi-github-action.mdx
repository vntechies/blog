---
authors: [hungran]
title: Sá»­ dá»¥ng Matrix/Matrices cho Github Actions
date: '2023-12-14'
tags: ['devops', 'github', 'cicd']
draft: false
images: ['/static/images/ogps/github-action-matrix.png']
summary: 'Táº­n Dá»¥ng tÃ­nh nÄƒng Matrix/Matrices Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a sá»‘ lÆ°á»£ng steps, jobs cáº§n thá»±c hiá»‡n láº·p láº¡i trong luá»“ng CI/CD á»Ÿ Github Actions'
---

# Táº­n Dá»¥ng TÃ­nh NÄƒng Matrices/Matrix cho Github Action Workflow

Xin chÃ o anh chá»‹ em Techies, liÃªn quan Ä‘áº¿n Github hay Github Actions cháº¯c háº³n anh chá»‹ em cÅ©ng khÃ´ng xa láº¡ gÃ¬, tuy nhiÃªn hÃ´m nay mÃ¬nh sáº½ chia sáº» láº¡i má»™t tÃ­nh nÄƒng khÃ¡ hÆ°u Ã­ch trong Actions Workflow Ä‘Ã³ lÃ  Matrix.

ğŸ˜… Gáº§n Ä‘Ã¢y mÃ¬nh cÃ³ tÃ¬nh cá» Ä‘Ã³ng gÃ³p cho dá»± Ã¡n [PipeCD - Sanbox CNCF (05/2023)](https://www.cncf.io/projects/pipecd/). Dá»± Ã¡n Ä‘ang sá»­ dá»¥ng Github Actions Build and Push Dockerimage tá»« Docker Inc.
Sáº½ cháº³ng cÃ³ váº¥n Ä‘á» gÃ¬ cho Ä‘áº¿n khi mÃ¬nh nhÃ¬n tháº¥y sá»‘ lÆ°á»£ng images Ä‘Æ°á»£c build vÃ  workflow file trÃ´ng nhÆ° tháº¿ nÃ y ğŸ˜… ğŸ˜… ğŸ˜“

![REPEAT](/static/images/assets/github/REPEAT.png)

### ğŸ˜“ Váº¥n Ä‘á» cá»§a workflow nÃ y lÃ  gÃ¬?

1. CÃ¡c job build image Ä‘Æ°á»£c láº·p láº¡i nhiá»u láº§n vá»›i cÃº phÃ¡p vÃ  sá»­ dá»¥ng chung cÃ¹ng má»™t action template tá»« docker
2. KhÃ³ maintain, khÃ³ cáº­p nháº­t khi muá»‘n thay Ä‘á»•i cáº£ image base version bÃªn trong Dockerfile

### ğŸ’¡ Giáº£i PhÃ¡p

Chá»‰ chá» cÃ³ váº­y, cá»™ng vá»›i viá»‡c mÃ¬nh Ä‘ang cÃ³ thÃªm má»™t vÃ i dá»± Ä‘á»‹nh vá»›i pháº§n CI build image cho chÃ­nh project PipeCD (nghe ráº¥t con gÃ  quáº£ trá»©ng...)

TrÆ°á»›c khi báº¯t tay vÃ o táº¡o Pull Request, cÃ¹ng nhau tÃ¬m hiá»ƒu trÆ°á»›c Github Matrix/Matrices lÃ  gÃ¬ nhÃ©, mÃ¬nh Ä‘Ã£ google tháº§n chÆ°á»Ÿng 123124821974 cÃ´ng lá»±c vÃ  ra Ä‘Æ°á»£c má»™t sá»‘ thÃ´ng tin nhÆ° dÆ°á»›i

Theo nhÆ° document cá»§a Github, Github Actions Matrices lÃ  tÃ­nh nÄƒng giÃºp cho ngÆ°á»i sá»­ dá»¥ng cÃ³ thá»ƒ láº·p láº¡i tá»± Ä‘á»™ng cÃ¡c job trong workflow dá»±a theo ma tráº­n biáº¿n... (áº£o).
Hiá»ƒu má»™t cÃ¡ch Ä‘Æ¡n giáº£n lÃ  giáº£m sá»‘ lÆ°á»£ng `steps` láº·p láº¡i dá»±a trÃªn cÃ¡c biáº¿n Ä‘áº§u vÃ o.

Nguá»“n: https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs

Nghe Ä‘áº¿n tá»« `ma tráº­n` thÃ¬ ráº¥t gÃ¬ vÃ  nÃ y ná», tuy nhiÃªn Ä‘á»ƒ báº¯t tay vÃ o lÃ m cÅ©ng khÃ´ng quÃ¡ khÃ³.

ğŸ“– Vá» cÃº phÃ¡p, Github hÆ°á»›ng dáº«n nhÆ° sau Ä‘á»ƒ khai `strategy` tá»« ma tráº­n Ä‘a chiá»u

VÃ­ dá»¥

```
strategy:
  matrix:
    fruit: [apple, pear]
    animal: [cat, dog]
    include:
      - color: green
      - color: pink
        animal: cat
      - fruit: apple
        shape: circle
      - fruit: banana
      - fruit: banana
        animal: cat
```

ta Ä‘Æ°á»£c káº¿t quáº£ Ä‘áº§u ra lÃ  object cÃ³ dáº¡ng nhÆ° sau:

- `{fruit: apple, animal: cat, color: pink, shape: circle}`
- `{fruit: apple, animal: dog, color: green, shape: circle}`
- `{fruit: pear, animal: cat, color: pink}`
- `{fruit: pear, animal: dog, color: green}`
- `{fruit: banana}`
- `{fruit: banana, animal: cat}`

ğŸ‘©â€ğŸ”¬ Ok, sau khi Ä‘á»c thÃªm hÆ°á»›ng dáº«n vá» viá»‡c má»Ÿ rá»™ng, lÆ°á»£c bá» ([include vÃ  exclude matrix configurations](https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs#expanding-or-adding-matrix-configurations)) cho giÃ¡ trá»‹ trong ma tráº­n mÃ¬nh tiáº¿n hÃ nh vÃ o viá»‡c thÃ´i

ğŸ‘¨â€ğŸ’» Káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  PR Ä‘Æ°á»£c approve, job cháº¡y mÆ°á»£t https://github.com/pipe-cd/pipecd/pull/4721

## VNTechies Dev Blog

Kho tÃ i nguyÃªn mÃ£ nguá»“n má»Ÿ vá»›i sá»© má»‡nh Ä‘Ã o táº¡o kiáº¿n thá»©c, Ä‘á»‹nh hÆ°á»›ng nghá» nghiá»‡p cho cá»™ng Ä‘á»“ng Cloud â˜ï¸ DevOps ğŸš€

[![Facebook page](https://i.imgur.com/YxfhUTS.png)](https://www.facebook.com/vntechies)

Tham gia group [VNTechies - Cloud â˜ï¸ / DevOps ğŸš€](https://www.facebook.com/groups/acevntechies) náº¿u báº¡n muá»‘n giao lÆ°u vá»›i cá»™ng Ä‘á»“ng vÃ  cáº­p nháº­t cÃ¡c thÃ´ng tin má»›i nháº¥t vá» Cloud vÃ  DevOps.

- Website: https://vntechies.dev
- Github repository: https://github.com/vntechies
- Facebook page: https://facebook.com/vntechies

[![Discord banner](https://images.viblo.asia/c8c4a473-c08d-45a3-be57-821781c1c256.png)](https://discord.com/invite/k2uDgd7NZ4)
[Link áº£nh trong bÃ i viáº¿t](https://collider.com/the-matrix-green-codes-explained/)

Anh chá»‹ em hÃ£y follow/á»§ng há»™ VNTechies Ä‘á»ƒ cáº­p nháº­t nhá»¯ng thÃ´ng tin má»›i nháº¥t vá» Cloud vÃ  DevOps nhÃ©!
